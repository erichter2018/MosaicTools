3.8.9
- Report popup: "insert / replace No change." buttons on IMPRESSION header (visible when comparison has a prior date)
- Fix: Clinical history dedup missing medical abbreviations (PE, PUD, HX, DVT, CHF, COPD, etc.)
- Fix: Aidoc notification cleared on throttled scrape ticks (now scrapes once per study, preserves state between ticks)
- Fix: Rainbow mode "central" causing false correlation (e.g. "central mediastinal lymph nodes" matching "central PE")
- Fix: Rainbow mode negative sentences matching on single shared term (e.g. "No pulmonary edema" matching "pulmonary emboli") — now requires 2+ substantive terms
- Fix: Rainbow mode continuation sentences ("This is best seen on...") split from parent finding — now merged for correlation
- Fix: Get Prior stripping body part from "CHEST-2 VIEWS" (order code prefix regex required letter after dash)
- STT: Deepgram keyterm prompting — boost recognition of specific medical terms (Settings > STT)

3.8.8
- Fix: Report popup showing intermediate text without impression after Process Report (now waits for IMPRESSION section)
- Fix: "Updating..." indicator appearing on popup re-opens long after Process Report (stale flag cleared when report stabilizes)
- Fix: Report popup closing prematurely during brief accession flaps (now waits for debounce before closing)
- Performance: Fast parent-search for ProseMirror editor (~10ms vs ~300ms full search) — Chrome destroys editor COM proxy every few seconds, parent container stays stable
- Performance: Correlation throttled during rapid edits (recomputes at most every 2s instead of every 1s)
- Performance: Eliminated redundant popup update when fast path and slow path return same text
- Performance: Eliminated unnecessary COM parent-wrapper churn (parent cached once, not re-fetched every tick)
- Cleanup: Removed dead TryReadCachedReportEditor code and tolerance/retry machinery

3.8.7
- Fix: Patient name from previous study sent to RVUCounter on study change (stale data for first accession check)
- Fix: DRAFTED status not detected when it appears before accession in Mosaic sibling order
- Performance: Single-pass extraction replaces 6+ separate FindFirstDescendant tree walks per scrape
- Performance: Cache "Current Study" parent container — skips full tree walk on accession checks
- Performance: Removed redundant targeted DRAFTED check (already extracted in single-pass)
- Performance: Patient name middle initial fix — prevents retry-every-tick when name has single-letter word
- Performance: UIA reset interval increased from 5min to 30min (cold-start penalty was 11-18s)

3.8.6
- Fix: Report popup briefly showing transcript text during editor rebuild after Process Report
- Fix: Report popup not clearing immediately on sign or accession change
- Fix: Patient name not sent via pipe to RVUCounter (extraction wiped by ordering bug)
- Fix: RadAI overlay stuck open after paste (verification retry + proceed on failure)
- Fix: Partial/transitional reports shown during Mosaic editor rebuild (restored U+FFFC filter with IMPRESSION fallback)
- Fix: Report popup "Updating..." indicator clearing before report actually updates (30s timeout)
- Performance: Instant report popup update after RadAI insert (bypass BatchUI deferral)
- Performance: Editor cache invalidation after Process Report (prevents 10-15s stale reads)
- Performance: ProseMirror search throttle relaxed to 3s during burst mode (was 10s)
- Performance: Reduced verbose correlation logging (CorrelateReversed inner-loop removed)

3.8.5
- Fix: COM wrapper memory leak in Clario recursive traversal (leaked 100K+ COM objects over a shift)
- Fix: COM wrapper leak in Aidoc widget scraping
- Fix: Set UIA transaction/connection timeouts (5s/10s) to prevent unbounded blocking
- Performance: Dedicated low-priority scrape thread replaces ThreadPool timer (prevents pool saturation)
- Performance: Timeout wrapper on heaviest UIA calls (patient info, Clario priority, fallback doc search)
- Performance: Throttle discard dialog check to 10s window after Process/Sign Report
- Performance: Clario priority retry capped at 5 with exponential backoff (3s→48s)
- Performance: Aidoc scrape throttled to 5s minimum interval
- Performance: Metadata sweep interval increased from 2s to 5s

3.8.4
- Performance: Cache report document and ProseMirror editor between scrapes (avoid expensive tree search every tick)
- Performance: Throttle metadata sweep (DRAFTED/Description) to every 2s instead of every scrape
- Performance: Adaptive report scrape throttle — steady-state polling slows to 2.5s when study is stable
- Performance: Burst mode — dictation, Process Report, and Show Report temporarily boost scrape rate
- Performance: Scrape thread runs at background priority to reduce input lag
- Cleanup: Remove legacy Python codebase (MosaicTools.pyw)

3.8.3
- STT: Auto-start recording on case open (new setting in STT > Display)
- STT: Auto-restart after Process Report, full stop on Sign Report

3.8.2
- Fix voice-activated macros being auto-inserted into transcript when a report is opened

3.8.1
- Auto-add patient age and sex to clinical history when auto-pasting corrected text
- Report popup: "IMPRESSION" header changes to "RadAI IMPRESSION" after successful RadAI insert

3.8.0
- Voice commands: say "process report" or "sign report" during dictation to trigger actions
- Voice macros: say "insert/macro {name}" during dictation to insert macro text
- Macro editor: new Voice Triggered option (purple indicator) — criteria fields hidden for voice macros
- STT pipeline refactor: each provider owns its full lifecycle (connect, flush, disconnect)
- STT: pre-connect after stop — next dictation starts instantly (no reconnection delay)
- STT: fix race condition when rapid PTT press overlaps background reconnection
- STT: Speechmatics now waits for server to deliver all finals before stopping
- STT: AssemblyAI waits for session Begin before sending audio (fixes silent sessions)

3.7.10
- STT: AssemblyAI medical keyterms boosting (90 radiology terms)
- STT: Speech tail buffer — last word no longer cut off on quick button release

3.7.9
- STT: Add AssemblyAI streaming provider
- STT: Fix audio buffer loss on stop — final words no longer cut off
- STT: Fix transcription bleed between PTT sessions
- STT: Add reconnect rate-limit protection for AssemblyAI
- Security: Remove PHI (patient names, MRNs, report text) from log output

3.7.8
- Fix RVU metrics resetting to defaults on restart when all metrics unchecked

3.7.7
- Fix windows appearing offscreen when monitor is disconnected or resolution changes

3.7.6
- Fix progressive system slowdown from FlaUI COM wrapper accumulation
- Cap patient info extraction retries to prevent unfiltered UI tree walks every scrape
- More aggressive GC for UIA COM object cleanup

3.7.5
- Fix RadAI auto-insert timing: wait for Mosaic editor to stabilize before inserting
- Prevent duplicate RadAI attempts when Process Report is pressed multiple times

3.7.4
- RadAI auto-insert on Process Report: generates and pastes impression automatically
- RadAI insert retry logic for more reliable IMPRESSION section detection

3.7.3
- RVU metrics: new RVU/Study and Avg/h display options
- Pace car: alternating display comparing current RVU pace to best/prior/avg shifts
- Expanded RVUCounter pipe integration with pace and per-study data

3.7.2
- STT: restore focus to previous app (InteleViewer) after pasting into Mosaic
- STT: fix spoken "colon" being swallowed — client-side punctuation replaces Deepgram dictation mode
- STT: remove unused settings (grow direction, auto-clear, confidence highlighting)
- Fix stroke detection purple border race condition

3.7.1
- Fix system beep sounds during STT dictation (ReadOnly RichTextBox in preview)
- Post-process dictation: spoken "colon" no longer converted to punctuation

3.7.0
- Custom STT Mode: cloud speech-to-text via Deepgram Nova-3 Medical (3.45% WER)
- Direct-to-Mosaic dictation: transcription pastes directly into Mosaic's transcript box
- Floating dictation indicator with live interim/final text display
- Per-word confidence highlighting (amber/red for low confidence)
- STT settings section: provider, API key, audio device, beeps, hotkeys
- Toggleable dictation indicator in settings

3.6.5
- Get Prior: better parsing of InteleViewer descriptions (order codes, abbreviations, missing "contrast")
- Fix named pipe access denied errors (explicit ACL)
- Fix stale indicator getting stuck on report popup (10s auto-clear)
- Report popup: pulsing yellow border and centered label when report is updating
- Report popup: fix max height clipping at screen bottom

3.6.4
- Fix RecoMD paste: recommendations now insert inside IMPRESSION section reliably
- Win32 clipboard API for reading Chromium clipboard (fixes empty reads from RecoMD)
- RecoMD send throttle: report text sent every 3rd tick instead of every tick
- Version rollback feature
- Remove dead code cleanup

3.6.3
- Fix keyboard lag and hotkeys dying: hook reinstall now on UI thread (was ThreadPool — no message pump)
- Smarter hook health: uses GetLastInputInfo to detect dead hook vs idle user, checks every 15s
- Remove legacy 0x04xx WndProc message translation

3.6.2
- Fix keyboard slowdown: stuck 500ms scrape timer, aggressive idle backoff, Win32 pre-checks
- Default scrape interval changed from 1s to 3s (adjustable in Settings)

3.6.1
- Another attempt at slowdown fix

3.6.0
- Deletable impression points: trash icons on report overlay to remove impression lines
- Fix system lag caused by scrape timer stuck at 500ms after study close
- Fix keyboard hook dying (hotkeys stop working) — faster recovery (90s vs 5min)
- Fix RichTextBox crash on app close (missing CodePages encoding)
- Performance: cache patient info between scrape ticks (skip expensive UI traversal)
- Performance: cache RecoMD window handle, skip discard dialog check when idle
- Use Ctrl+End instead of PageDown for impression scroll (fixes short reports)
- Aidoc pixel verification for positive finding detection
- RadAI overlay mode for impression display
- Improved correlation/rainbow mode highlighting

3.5.2
- Backward compatibility for legacy AHK message IDs (0x04xx)
- Right-click "Show Log" option on main bar and tray icon
- RadAI and RecoMD message endpoints documented in Reference section

3.5.1
- Fix hotkeys not working in headless mode
- Reduce verbose RecoMD logging

3.5.0
- RecoMD integration: send report data to RecoMD for best practice recommendations
- RecoMD auto-send option after Process Report
- Aidoc integration: scrape Aidoc findings and display in clinical history window
- RadAI Impression: fetch AI-generated impressions via RadAI API
- Windows message endpoints for RadAI and RecoMD (AHK integration)
- Improved patient name extraction with medical term exclusions
- Code audit: thread safety, resource leaks, async safety fixes

3.1.5
- Fix critical findings name extraction when doctor name includes title prefix (e.g. "Dr.")
- Fix number keys (0-9) not working in hotkey capture fields
- NumPad key support for hotkeys

3.1.4
- Mic Gain Calibrator: measure mic levels and calculate optimal Windows input gain for voice recognition
- Acknowledgments section in Profile settings

3.1.3
- Discard Study now works reliably on first press
- Settings dialogs no longer open behind other windows
- Macro and pick list counts now display correctly in settings
- Bug fixes

3.1.2
- Macro editor: Backup/Restore feature for importing and exporting macros
- Auto-update setting moved from Experimental to Desktop Mode section

3.1.1
- Philips SpeechMike support in Event mode

3.1.0
- Settings redesign: new sectioned layout with search functionality
- Timezone setting for Critical Findings: convert times to your local timezone
- New Button Studio and Key Mappings dialogs for easier configuration
